<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Installing Nix and Home Manager in Arch Linux | #!/matt/rathbun</title>
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3/build/web/hack.css">

      <link rel="stylesheet" href="/css/colors.min.92abca9f41b52525c2ff2580c9f497515ac5dbff51933616a7596178d5f4d6de.css" integrity="sha256-kqvKn0G1JSXC/yWAyfSXUVrF2/9RkzYWp1lheNX01t4=" crossorigin="anonymous">
      <link rel="stylesheet" href="/css/main.min.88edba46de268a85d5e454a937ada407a32f9054be4b10ce2e27bc80b0e7eac4.css" integrity="sha256-iO26Rt4mioXV5FSpN62kB6MvkFS&#43;SxDOLie8gLDn6sQ=" crossorigin="anonymous">
      <link rel="stylesheet" href="/css/syntax.min.b840b9ed282a8d467cd5fb90af17571bda7b0cdcca46af05b6f2e9ac8b0377f9.css" integrity="sha256-uEC57SgqjUZ81fuQrxdXG9p7DNzKRq8FtvLprIsDd/k=" crossorigin="anonymous">


</head>
<body>
  <header>
    <div class="nav">
  <a href="/" class="accent">#!/matt/rathbun</a>
  <a href="/posts" class="left">/posts</a>

  <a href="https://github.com/mattbun" class="right">github</a>
</div>

  </header>
  <main>
    
  <h1>Installing Nix and Home Manager in Arch Linux</h1>

  
  
  <time datetime="2022-10-04T00:00:00&#43;00:00">October 4, 2022</time>
  |
  
    <a class="tag" href="/tags/arch/">#arch</a>
    <a class="tag" href="/tags/home-manager/">#home-manager</a>
    <a class="tag" href="/tags/linux/">#linux</a>
    <a class="tag" href="/tags/nix/">#nix</a>


  <br>
  <br>
  <p>Hi, I&rsquo;m Matt and I&rsquo;m one of those masochists who uses a chromebook as their personal development machine (not work though, I&rsquo;m not <em>that</em> crazy). A cool thing about Chrome OS&rsquo;s Linux support is that you can swap the default, <em>boring</em> Debian container for any LXC image. <a href="https://wiki.archlinux.org/title/Chrome_OS_devices/Crostini">Here&rsquo;s an archwiki page on how to swap it to Arch!</a></p>
<p>A not-so-cool thing about that LXC setup is that there isn&rsquo;t a NixOS LXC image available ðŸ˜¢. Instead, I set up an Arch Linux container with Nix and Home Manager. Best of both worlds I guess? Here&rsquo;s how to do it.</p>
<h1 id="what-were-setting-up">What we&rsquo;re setting up</h1>
<p>In these instructions, I&rsquo;ll be setting up <code>nix</code> and <code>home-manager</code>. This setup doesn&rsquo;t let you configure system-level things in nix like in NixOS, but you <em>can</em> configure things for your user using <code>home-manager</code>. If you set up <a href="https://github.com/nix-community/nix-direnv">nix-direnv</a> in your home-manager config, you can add nix configurations for specific directories.</p>
<p>This should work for any Arch Linux install, not just my weird LXC image.</p>
<h1 id="lets-go">Let&rsquo;s go!</h1>
<ol>
<li>
<p>Install nix</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo pacman -S nix
</span></span></code></pre></div></li>
<li>
<p>Enable and start <code>nix-daemon</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> nix-daemon
</span></span><span class="line"><span class="cl">sudo systemctl start nix-daemon
</span></span></code></pre></div></li>
<li>
<p>Add your user to the <code>nix-users</code> group</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo gpasswd -a &lt;user&gt; nix-users
</span></span></code></pre></div></li>
<li>
<p>Log out and back in again for the group change to take effect</p>
</li>
<li>
<p>Add <code>nixpkgs</code> and <code>home-manager</code> channels</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">nix-channel --add https://nixos.org/channels/nixpkgs-unstable
</span></span><span class="line"><span class="cl">nix-channel --add https://github.com/nix-community/home-manager/archive/master.tar.gz home-manager
</span></span><span class="line"><span class="cl">nix-channel --update
</span></span></code></pre></div></li>
<li>
<p>Install home-manager</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">NIX_PATH</span><span class="o">=</span><span class="nv">$HOME</span>/.nix-defexpr/channels:/nix/var/nix/profiles/per-user/root/channels<span class="si">${</span><span class="nv">NIX_PATH</span><span class="p">:+:</span><span class="nv">$NIX_PATH</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">nix-shell <span class="s1">&#39;&lt;home-manager&gt;&#39;</span> -A install
</span></span></code></pre></div></li>
<li>
<p>Take a look at <code>~/.config/nixpkgs/home.nix</code>, make any desired changes, then run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">home-manager switch
</span></span></code></pre></div></li>
</ol>
<p>And that should be it! Enjoy!</p>
<p><img src="/posts/nix-arch/nix-arch-cowsay.png" alt="A nix shell running â€˜cat /etc/os-release | cowsayâ€™"></p>
<h1 id="for-more-info">For more info&hellip;</h1>
<p>These instructions are basically a condensed version of these two pages:</p>
<ul>
<li><a href="https://wiki.archlinux.org/title/Nix">Nix - ArchWiki</a></li>
<li><a href="https://nix-community.github.io/home-manager/index.html#sec-install-standalone">Home Manager standalone installation</a></li>
</ul>

  </main>
  <footer>
    <p>Copyright 2025 Matt Rathbun. Made with <a href="https://gohugo.io/"> Hugo </a> and <a href="https://0x96f.dev/theme">0x96f</a>.</p>

  </footer>
</body>
</html>
